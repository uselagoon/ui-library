# @uselagoon/ui-library

A component library based on [Shadcn](https://ui.shadcn.com/) and [Tailwind](https://tailwindcss.com/) for all things Lagoon related.

## Installation ğŸ’¾

### 1. Configure npm registry

Create or update `.npmrc` in your project root:

```
@uselagoon:registry=https://npm.pkg.github.com
```

You may need to authenticate with GitHub Packages. See [GitHub Packages authentication](https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry#authenticating-to-github-packages).

### 2. Install the package

```bash
npm install @uselagoon/ui-library tailwindcss @tailwindcss/postcss postcss
```

Or with yarn:

```bash
yarn add @uselagoon/ui-library tailwindcss @tailwindcss/postcss postcss
```

### 3. Import styles

Add the UI library styles to your root layout:

```tsx
import '@uselagoon/ui-library/dist/ui-library.css';
```

## Usage ğŸ”¨

Using a component from the library:

```tsx
import '@uselagoon/ui-library/dist/ui-library.css';
import { Button, SwitchWithDescription } from '@uselagoon/ui-library';


export default () => (
  <>
    <Button variant="ghost" disabled>A spooky disabled button</Button>
    <SwitchWithDescription
      description="This is a switch description."
      id="first"
      label="Switch Text"
    />
  </>
);
```

## Storybook ğŸ¨

View the component documentation on Chromatic (URL available after setup).

### Storybook Composition

To include UI library stories in your project's Storybook, add to your `.storybook/main.ts`:

```typescript
import type { StorybookConfig } from '@storybook/react-vite';

const config: StorybookConfig = {
  // ... your existing config
  refs: {
    'ui-library': {
      title: 'Lagoon UI Library',
      url: 'https://<branch>--<app-id>.chromatic.com/', // Get URL from Chromatic dashboard
    },
  },
};

export default config;
```

## CI/CD

### Automated Workflows

| Workflow | Trigger | Actions |
|----------|---------|---------|
| **CI** | Push to main, PRs | Type check, lint, format check, build, build Storybook |
| **Publish** | GitHub Release published | All CI checks + publish to GitHub Packages |
| **Chromatic** | Push to main, PRs | Deploy Storybook to Chromatic (when token configured) |

### Publishing a New Version

1. Update version in `package.json`
2. Commit and push to main
3. Create a GitHub Release with a new tag (e.g., `v2.1.0`)
4. The publish workflow automatically builds and publishes to GitHub Packages

## Development guide ğŸ—ï¸

Clone the repo locally:

```bash
git clone https://github.com/uselagoon/ui-library.git
cd ui-library
npm install
npm run storybook
```

It is recommended to build components in isolation with the help of storybook (currently V 9.0).

Open your browser and visit [http://localhost:6006](http://localhost:6006).

The project structure is as follows:

â”œâ”€â”€ src
â”‚ â”œâ”€â”€ components # React source code and demos (which then get bundled)
â”‚ â”œâ”€â”€ hooks # Custom hooks
â”‚ â”œâ”€â”€ providers # Custom theme and NextLink providers
â”‚ â”œâ”€â”€ stories # Storybook stories
â”‚ â”œâ”€â”€ index.css # Autogenerated tailwind css file
â”‚ â””â”€â”€ index.ts # Entrypoint for your `exported` components (that your project then imports)
â”œâ”€â”€ eslint.config.js # Eslint config
â”œâ”€â”€ vite.config.ts # Vite bundler config
â””â”€â”€ package.json

Given that there's a storybook instance running, navigate to the `src` directory and modify/create new components with their respective `stories.tsx` files.

Modify and customize anything with Tailwind and/or custom css files if needed.

Then run the lint and format scripts, and you're ready to go!

```bash
npm run typecheck    # TypeScript check
npm run lint         # ESLint
npm run format       # Prettier formatting
```

### Adding Shadcn Components

To add a new component from Shadcn, refer to the [Shadcn CLI guide](https://ui.shadcn.com/docs/cli).

## Contributing ğŸ¤

PRs and issues are welcome, we invite contributions from everyone.

This guide could come in handy: [GitHub contribution guide](https://egghead.io/courses/how-to-contribute-to-an-open-source-project-on-github)
