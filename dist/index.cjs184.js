"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const w=require("./index.cjs156.js"),c=require("./index.cjs171.js"),sn=require("./index.cjs209.js"),Ve=require("./index.cjs265.js"),Z=require("./index.cjs121.js"),cn=require("./index.cjs146.js"),xe=require("./index.cjs203.js"),ke=require("./index.cjs270.js"),S=require("./index.cjs172.js"),fn=require("./index.cjs271.js"),b=require("./index.cjs173.js"),dn=require("./index.cjs269.js"),pn=require("react"),gn=require("./index.cjs272.js"),vn=require("./index.cjs273.js"),qe=require("./index.cjs274.js"),mn=require("./index.cjs275.js"),hn=require("./index.cjs276.js"),Pn=require("./index.cjs277.js"),Cn=require("./index.cjs278.js"),ee=require("./index.cjs279.js");function Mn(g){const m=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(g){for(const t in g)if(t!=="default"){const $=Object.getOwnPropertyDescriptor(g,t);Object.defineProperty(m,t,$.get?$:{enumerable:!0,get:()=>g[t]})}}return m.default=g,Object.freeze(m)}const o=Mn(pn);var Rn=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function Le(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ve.default,m=o.forwardRef(function(t,$){var te=t.prefixCls,A=te===void 0?"rc-trigger-popup":te,ze=t.children,ne=t.action,He=ne===void 0?"hover":ne,Ie=t.showAction,je=t.hideAction,h=t.popupVisible,Be=t.defaultPopupVisible,z=t.onPopupVisibleChange,H=t.afterPopupVisibleChange,I=t.mouseEnterDelay,oe=t.mouseLeaveDelay,j=oe===void 0?.1:oe,Fe=t.focusDelay,We=t.blurDelay,ae=t.mask,re=t.maskClosable,Xe=re===void 0?!0:re,Ye=t.getPopupContainer,Je=t.forceRender,Ge=t.autoDestroy,Ke=t.destroyPopupOnHide,Qe=t.popup,Ue=t.popupClassName,Ze=t.popupStyle,B=t.popupPlacement,ue=t.builtinPlacements,P=ue===void 0?{}:ue,ie=t.popupAlign,et=t.zIndex,le=t.stretch,N=t.getPopupClassNameFromAlign,tt=t.fresh,y=t.alignPoint,nt=t.onPopupClick,ot=t.onPopupAlign,F=t.arrow,at=t.popupMotion,rt=t.maskMotion,ut=t.popupTransitionName,it=t.popupAnimation,lt=t.maskTransitionName,st=t.maskAnimation,se=t.className,ct=t.getTriggerDOMNode,W=sn.default(t,Rn),ft=Ge||Ke||!1,dt=o.useState(!1),ce=c.default(dt,2),pt=ce[0],gt=ce[1];b.default(function(){gt(dn.default())},[]);var fe=o.useRef({}),v=o.useContext(qe.default),vt=o.useMemo(function(){return{registerSubPopup:function(n,a){fe.current[n]=a,v?.registerSubPopup(n,a)}}},[v]),mt=fn.default(),ht=o.useState(null),de=c.default(ht,2),i=de[0],Pt=de[1],pe=o.useRef(null),Ct=S.default(function(e){pe.current=e,xe.isDOM(e)&&i!==e&&Pt(e),v?.registerSubPopup(mt,e)}),Mt=o.useState(null),ge=c.default(Mt,2),p=ge[0],Rt=ge[1],ve=o.useRef(null),St=S.default(function(e){xe.isDOM(e)&&p!==e&&(Rt(e),ve.current=e)}),E=o.Children.only(ze),f=E?.props||{},C={},bt=S.default(function(e){var n,a,u=p;return u?.contains(e)||((n=ke.getShadowRoot(u))===null||n===void 0?void 0:n.host)===e||e===u||i?.contains(e)||((a=ke.getShadowRoot(i))===null||a===void 0?void 0:a.host)===e||e===i||Object.values(fe.current).some(function(r){return r?.contains(e)||e===r})}),At=ee.getMotion(A,at,it,ut),yt=ee.getMotion(A,rt,st,lt),Tt=o.useState(Be||!1),me=c.default(Tt,2),Dt=me[0],he=me[1],l=h??Dt,wt=S.default(function(e){h===void 0&&he(e)});b.default(function(){he(h||!1)},[h]);var T=o.useRef(l);T.current=l;var O=o.useRef([]);O.current=[];var Pe=S.default(function(e){var n;wt(e),((n=O.current[O.current.length-1])!==null&&n!==void 0?n:l)!==e&&(O.current.push(e),z?.(e))}),Ce=o.useRef(),Me=function(){clearTimeout(Ce.current)},d=function(n){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;Me(),a===0?Pe(n):Ce.current=setTimeout(function(){Pe(n)},a*1e3)};o.useEffect(function(){return Me},[]);var $t=o.useState(!1),Re=c.default($t,2),X=Re[0],Se=Re[1];b.default(function(e){(!e||l)&&Se(!0)},[l]);var Nt=o.useState(null),be=c.default(Nt,2),Y=be[0],Ae=be[1],Et=o.useState(null),ye=c.default(Et,2),J=ye[0],Ot=ye[1],_=function(n){Ot([n.clientX,n.clientY])},_t=hn.default(l,i,y&&J!==null?J:p,B,P,ie,ot),s=c.default(_t,11),xt=s[0],kt=s[1],qt=s[2],Vt=s[3],Lt=s[4],zt=s[5],Ht=s[6],It=s[7],jt=s[8],x=s[9],G=s[10],Bt=mn.default(pt,He,Ie,je),Te=c.default(Bt,2),k=Te[0],D=Te[1],De=k.has("click"),q=D.has("click")||D.has("contextMenu"),M=S.default(function(){X||G()}),Ft=function(){T.current&&y&&q&&d(!1)};Pn.default(l,p,i,M,Ft),b.default(function(){M()},[J,B]),b.default(function(){l&&!(P!=null&&P[B])&&M()},[JSON.stringify(ie)]);var Wt=o.useMemo(function(){var e=ee.getAlignPopupClassName(P,A,x,y);return Z.default(e,N?.(x))},[x,N,P,A,y]);o.useImperativeHandle($,function(){return{nativeElement:ve.current,popupElement:pe.current,forceAlign:M}});var Xt=o.useState(0),we=c.default(Xt,2),Yt=we[0],Jt=we[1],Gt=o.useState(0),$e=c.default(Gt,2),Kt=$e[0],Qt=$e[1],Ne=function(){if(le&&p){var n=p.getBoundingClientRect();Jt(n.width),Qt(n.height)}},Ut=function(){Ne(),M()},Zt=function(n){Se(!1),G(),H?.(n)},en=function(){return new Promise(function(n){Ne(),Ae(function(){return n})})};b.default(function(){Y&&(G(),Y(),Ae(null))},[Y]);function R(e,n,a,u){C[e]=function(r){var V;u?.(r),d(n,a);for(var U=arguments.length,_e=new Array(U>1?U-1:0),L=1;L<U;L++)_e[L-1]=arguments[L];(V=f[e])===null||V===void 0||V.call.apply(V,[f,r].concat(_e))}}(De||q)&&(C.onClick=function(e){var n;T.current&&q?d(!1):!T.current&&De&&(_(e),d(!0));for(var a=arguments.length,u=new Array(a>1?a-1:0),r=1;r<a;r++)u[r-1]=arguments[r];(n=f.onClick)===null||n===void 0||n.call.apply(n,[f,e].concat(u))});var tn=Cn.default(l,q,p,i,ae,Xe,bt,d),nn=k.has("hover"),on=D.has("hover"),K,Ee;nn&&(R("onMouseEnter",!0,I,function(e){_(e)}),R("onPointerEnter",!0,I,function(e){_(e)}),K=function(n){(l||X)&&i!==null&&i!==void 0&&i.contains(n.target)&&d(!0,I)},y&&(C.onMouseMove=function(e){var n;(n=f.onMouseMove)===null||n===void 0||n.call(f,e)})),on&&(R("onMouseLeave",!1,j),R("onPointerLeave",!1,j),Ee=function(){d(!1,j)}),k.has("focus")&&R("onFocus",!0,Fe),D.has("focus")&&R("onBlur",!1,We),k.has("contextMenu")&&(C.onContextMenu=function(e){var n;T.current&&D.has("contextMenu")?d(!1):(_(e),d(!0)),e.preventDefault();for(var a=arguments.length,u=new Array(a>1?a-1:0),r=1;r<a;r++)u[r-1]=arguments[r];(n=f.onContextMenu)===null||n===void 0||n.call.apply(n,[f,e].concat(u))}),se&&(C.className=Z.default(f.className,se));var Q=w.default(w.default({},f),C),Oe={},an=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];an.forEach(function(e){W[e]&&(Oe[e]=function(){for(var n,a=arguments.length,u=new Array(a),r=0;r<a;r++)u[r]=arguments[r];(n=Q[e])===null||n===void 0||n.call.apply(n,[Q].concat(u)),W[e].apply(W,u)})});var rn=o.cloneElement(E,w.default(w.default({},Q),Oe)),un={x:zt,y:Ht},ln=F?w.default({},F!==!0?F:{}):null;return o.createElement(o.Fragment,null,o.createElement(cn.default,{disabled:!l,ref:St,onResize:Ut},o.createElement(vn.default,{getTriggerDOMNode:ct},rn)),o.createElement(qe.default.Provider,{value:vt},o.createElement(gn.default,{portal:g,ref:Ct,prefixCls:A,popup:Qe,className:Z.default(Ue,Wt),style:Ze,target:p,onMouseEnter:K,onMouseLeave:Ee,onPointerEnter:K,zIndex:et,open:l,keepDom:X,fresh:tt,onClick:nt,onPointerDownCapture:tn,mask:ae,motion:At,maskMotion:yt,onVisibleChanged:Zt,onPrepare:en,forceRender:Je,autoDestroy:ft,getPopupContainer:Ye,align:x,arrow:ln,arrowPos:un,ready:xt,offsetX:kt,offsetY:qt,offsetR:Vt,offsetB:Lt,onAlign:M,stretch:le,targetWidth:Yt/It,targetHeight:Kt/jt})))});return process.env.NODE_ENV!=="production"&&(m.displayName="Trigger"),m}const Sn=Le(Ve.default);exports.default=Sn;exports.generateTrigger=Le;
