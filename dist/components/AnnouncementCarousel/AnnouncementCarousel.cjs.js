"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("react/jsx-runtime"),o=require("react"),f=require("../ui/carousel.cjs.js"),L=require("../AnnouncementCard/AnnouncementCard.cjs.js"),c=require("../../_util/helpers.cjs.js"),m=require("../../lib/utils.cjs.js"),g="promo-card-dismissed";function h(n){return n?`announcement-dismissed-${n}`:g}function T(n){return c.getLocalStorage(h(n))===!0}function A({cards:n,showDots:C=!0,expiryDays:r=30,className:w}){const[t,b]=o.useState(),[a,S]=o.useState([]),[j,p]=o.useState(!1),[N,x]=o.useState(0);o.useEffect(()=>{c.getLocalStorage(g)===!0&&n.find(i=>i.id==="whats-new")&&(c.setLocalStorage(h("whats-new"),!0,r),localStorage.removeItem(g));const e=n.filter(s=>!T(s.id));S(e),p(!0)},[n,r]),o.useEffect(()=>{if(!t)return;const e=()=>{x(t.selectedScrollSnap())};return t.on("select",e),e(),()=>{t.off("select",e)}},[t]);const v=o.useCallback(e=>{e&&c.setLocalStorage(h(e),!0,r);const s=t?.selectedScrollSnap()??0;S(i=>{const u=i.filter(d=>d.id!==e);if(t&&u.length>0){const d=s>=u.length?u.length-1:s;setTimeout(()=>{t.scrollTo(d)},0)}return u})},[t,r]),q=e=>{t?.scrollTo(e)};if(!j||a.length===0)return null;const I=C&&a.length>1;return l.jsxs("div",{className:m.cn("w-full",w),children:[l.jsx(f.Carousel,{setApi:b,opts:{align:"start",loop:!1},children:l.jsx(f.CarouselContent,{className:"-ml-0",children:a.map(e=>l.jsx(f.CarouselItem,{className:"pl-0 flex items-end",children:l.jsx(L.default,{...e,onClose:v,disabled:!1,className:m.cn("w-full",e.className)})},e.id||"default"))})}),I&&l.jsx("div",{className:"flex justify-center gap-1.5 mt-0.5",children:a.map((e,s)=>l.jsx("button",{onClick:()=>q(s),className:m.cn("h-1.5 w-1.5 rounded-full transition-colors",s===N?"bg-foreground":"bg-foreground/30 hover:bg-foreground/50"),"aria-label":`Go to slide ${s+1}`},e.id||s))})]})}exports.default=A;
