"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("react/jsx-runtime"),a=require("react"),x=require("./ChangeLog.cjs.js"),v=require("../../schemas/changeLog.cjs.js");function w({sourceData:r,refetchInterval:s=6e5,fallbackData:i=[],onError:h,showLoading:m=!0}){const[l,d]=a.useState(i),[j,o]=a.useState(!!r),[g,u]=a.useState(null);return a.useEffect(()=>{if(!r){o(!1);return}const f=async()=>{try{o(!0),u(null);const e=await fetch(r,{cache:"no-cache"});if(!e.ok)throw new Error(`Failed to fetch changelog data: ${e.statusText}`);const n=await e.json(),c=v.ChangeLogDataSchema.safeParse(n);if(!c.success)throw console.error("Changelog validation failed:",c.error.format()),new Error("Invalid changelog data format");d(c.data.changes)}catch(e){const n=e instanceof Error?e:new Error("Unknown error");u(n),h?.(n),d(i)}finally{o(!1)}};if(f(),s>0){const e=setInterval(f,s);return()=>clearInterval(e)}},[r,s]),j&&m?t.jsx("div",{className:"flex items-center justify-center p-8",children:t.jsx("div",{className:"text-gray-500",children:"Loading changelog..."})}):g&&l.length===0?t.jsx("div",{className:"flex items-center justify-center p-8",children:t.jsxs("div",{className:"text-red-500",children:["Failed to load changelog. ",g.message]})}):t.jsx(x.default,{changeLogItems:l})}exports.default=w;
