"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const t=require("react/jsx-runtime"),r=require("react"),x=require("./ChangeFeed.cjs.js"),v=require("../../schemas/changeFeed.cjs.js");function w({sourceData:a="https://raw.githubusercontent.com/amazeeio/lagoon-changefeed-data/refs/heads/main/changefeed.json",refetchInterval:s=6e5,fallbackData:i=[],onError:g,showLoading:m=!0}){const[d,l]=r.useState(i),[j,o]=r.useState(!!a),[f,u]=r.useState(null);return r.useEffect(()=>{if(!a){o(!1);return}const h=async()=>{try{o(!0),u(null);const e=await fetch(a,{cache:"no-cache"});if(!e.ok)throw new Error(`Failed to fetch change feed data: ${e.statusText}`);const n=await e.json(),c=v.ChangeFeedDataSchema.safeParse(n);if(!c.success)throw console.error("Changefeed validation failed:",c.error.format()),new Error("Invalid changefeed data format");l(c.data.changes)}catch(e){const n=e instanceof Error?e:new Error("Unknown error");u(n),g?.(n),l(i)}finally{o(!1)}};if(h(),s>0){const e=setInterval(h,s);return()=>clearInterval(e)}},[a,s]),j&&m?t.jsx("div",{className:"flex items-center justify-center p-8",children:t.jsx("div",{className:"text-gray-500",children:"Loading changefeed..."})}):f&&d.length===0?t.jsx("div",{className:"flex items-center justify-center p-8",children:t.jsxs("div",{className:"text-red-500",children:["Failed to load changefeed. ",f.message]})}):t.jsx(x.default,{changeFeedItems:d})}exports.default=w;
